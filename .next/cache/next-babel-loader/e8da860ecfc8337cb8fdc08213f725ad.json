{"ast":null,"code":"var __jsx = React.createElement;\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { Typography, Paper } from \"@material-ui/core\";\nimport withAuth from \"../../components/WithAuth\";\nimport WithDrawerAppBar from \"../../components/WithDrawerAppBar\";\nimport Tempmeter from \"../../components/Tempmeter\";\nimport Termostat from \"../../components/Termostat\";\nimport { firebase } from \"../../firebase/index\";\nimport { Line } from \"react-chartjs-2\";\nimport onlyDesktop from \"../../components/OnlyDesktop\";\nconst useStyle = makeStyles(theme => ({\n  center: {\n    display: 'flex'\n  },\n  controllComponent: {\n    margin: '50px',\n    width: 'min-content',\n    padding: '1rem'\n  }\n}));\n\nfunction Id(props) {\n  const classes = useStyle();\n  const {\n    0: temp,\n    1: setTemp\n  } = useState(-50);\n  const {\n    0: tempHistoryCharData,\n    1: setTempHistoryCharData\n  } = useState();\n  const {\n    0: tempHistoryCharLabels,\n    1: setTempHistoryCharLabels\n  } = useState();\n  const {\n    0: defTemp,\n    1: setDefTemp\n  } = useState();\n  const router = useRouter();\n  const {\n    id\n  } = router.query;\n  const timeFormat = 'MM/DD/YYYY HH:mm';\n  let tempData = firebase.database().ref(\"/users/\" + props.user + \"/devices/\" + id + \"/temp\");\n  let tempHistoryData = firebase.database().ref(\"/users/\" + props.user + \"/devices/\" + id + \"/temps\");\n  let targetTempData = firebase.database().ref(\"/users/\" + props.user + \"/devices/\" + id + \"/targetTemp\");\n\n  const termostatChange = value => {\n    firebase.database().ref(\"/users/\" + props.user + \"/devices/\" + id + \"/targetTemp\").set(value);\n  };\n\n  useEffect(() => {\n    tempData.on('value', data => {\n      setTemp(data.val());\n    });\n    tempHistoryData.on('value', data => {\n      let charData = [];\n      let charLabels = [];\n      Object.keys(data.val()).forEach(key => {\n        charData.push(data.val()[key].temp);\n        charLabels.push(data.val()[key].time[1] + '/' + data.val()[key].time[2] + '/' + data.val()[key].time[0] + ' ' + data.val()[key].time[3] + ':' + data.val()[key].time[4]);\n      });\n      setTempHistoryCharData(charData);\n      setTempHistoryCharLabels(charLabels);\n    });\n    targetTempData.once('value', data => {\n      setDefTemp(data.val());\n    });\n  }, []);\n  return __jsx(\"div\", null, __jsx(Typography, {\n    component: \"h1\",\n    variant: \"h2\"\n  }, \"Teplota\"), __jsx(\"div\", {\n    className: classes.center\n  }, __jsx(\"div\", {\n    className: classes.controllComponent\n  }, __jsx(Paper, {\n    elevation: 3,\n    style: {\n      padding: '1rem'\n    }\n  }, __jsx(Tempmeter, {\n    theme: props.theme,\n    temp: temp\n  }))), __jsx(\"div\", {\n    className: classes.controllComponent\n  }, __jsx(Paper, {\n    elevation: 3,\n    style: {\n      padding: '1rem'\n    }\n  }, __jsx(Termostat, {\n    theme: props.theme,\n    onValueChanged: termostatChange,\n    defaultValue: defTemp\n  })))), __jsx(\"div\", {\n    className: classes.center\n  }, __jsx(\"div\", {\n    className: classes.controllComponent,\n    style: {\n      width: 'calc(100% - 100px)'\n    }\n  }, __jsx(Paper, null, __jsx(Line, {\n    data: {\n      labels: tempHistoryCharLabels,\n      datasets: [{\n        label: 'temp',\n        data: tempHistoryCharData,\n        backgroundColor: 'rgba(0,0,0,0)',\n        pointBackgroundColor: 'red',\n        borderColor: 'red',\n        borderWidth: 0\n      }]\n    },\n    options: {\n      scales: {\n        xAxes: [{\n          gridLines: {\n            display: false\n          }\n        }],\n        yAxes: [{\n          gridLines: {\n            color: props.theme == 1 ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)',\n            zeroLineColor: props.theme == 1 ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)',\n            drawTicks: false\n          },\n          ticks: {\n            stepSize: 10,\n            padding: 10\n          }\n        }]\n      },\n      maintainAspectRatio: false\n      /*xAxes:[{\r\n        }]*/\n\n    }\n  })))));\n}\n\nfunction ex(props) {\n  const router = useRouter();\n  const {\n    id\n  } = router.query;\n  const {\n    0: name,\n    1: setName\n  } = useState(\"\");\n  let nameData = firebase.database().ref(\"/users/\" + props.user + \"/devices/\" + id + \"/name\");\n  useEffect(() => {\n    nameData.on('value', data => {\n      setName(data.val());\n    });\n  }, []);\n  return __jsx(WithDrawerAppBar, {\n    component: Id,\n    title: name,\n    deviceId: id.toString(),\n    componentProps: props\n  });\n}\n\nexport default onlyDesktop(withAuth(ex));","map":null,"metadata":{},"sourceType":"module"}