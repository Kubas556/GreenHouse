{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Jakub Sedlak\\\\WebstormProjects\\\\projekt_CP - typescript\\\\pages\\\\irrigation\\\\[id].tsx\";\nvar __jsx = React.createElement;\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { Typography, Paper } from \"@material-ui/core\";\nimport withAuth from \"../../components/WithAuth\";\nimport WithDrawerAppBar from \"../../components/WithDrawerAppBar\";\nimport { firebase } from \"../../firebase/index\";\nimport { Line } from \"react-chartjs-2\";\nimport onlyDesktop from \"../../components/OnlyDesktop\";\nimport SoilHumidity from \"../../components/SoilHumidity\";\nimport AirHumidity from \"../../components/AirHumidity\";\nconst useStyle = makeStyles(theme => ({\n  center: {\n    display: 'flex',\n    width: 'calc(100% - 1px)'\n  },\n  page: {\n    width: '100%',\n    position: 'relative'\n  },\n  controllComponent: {\n    margin: '50px',\n    width: 'min-content',\n    padding: '1rem'\n  }\n}));\n\nfunction Id(props) {\n  const classes = useStyle();\n  const {\n    0: soilHumidity,\n    1: setSoilHumidity\n  } = useState(0);\n  const {\n    0: airHumidity,\n    1: setAirHumidity\n  } = useState(0);\n  const {\n    0: airHumidityHistoryCharData,\n    1: setAirHumidityHistoryCharData\n  } = useState();\n  const {\n    0: aitHumidityHistoryCharLabels,\n    1: setAirHumidityHistoryCharLabels\n  } = useState();\n  const {\n    0: defTemp,\n    1: setDefTemp\n  } = useState();\n  const router = useRouter();\n  const {\n    id\n  } = router.query;\n  const timeFormat = 'MM/DD/YYYY HH:mm';\n  let soilHumidityData = firebase.database().ref(\"/users/\" + props.user + \"/devices/\" + id + \"/soilHumidity\");\n  let airHumidityData = firebase.database().ref(\"/users/\" + props.user + \"/devices/\" + id + \"/airHumidity\");\n  let humidityHistoryData = firebase.database().ref(\"/users/\" + props.user + \"/devices/\" + id + \"/history/airHumidity\"); //let targetTempData = firebase.database().ref(\"/users/\"+props.user+\"/devices/\"+id+\"/targetTemp\");\n\n  const termostatChange = value => {\n    firebase.database().ref(\"/users/\" + props.user + \"/devices/\" + id + \"/targetTemp\").set(value);\n  };\n\n  useEffect(() => {\n    soilHumidityData.on('value', data => {\n      setSoilHumidity(data.val());\n    });\n    airHumidityData.on('value', data => {\n      setAirHumidity(data.val());\n    });\n    humidityHistoryData.on('value', data => {\n      let charData = [];\n      let charLabels = [];\n      Object.keys(data.val()).forEach(key => {\n        charData.push(data.val()[key].value);\n        charLabels.push(data.val()[key].time[1] + '/' + data.val()[key].time[2] + '/' + data.val()[key].time[0] + ' ' + data.val()[key].time[3] + ':' + data.val()[key].time[4]);\n      });\n      setAirHumidityHistoryCharData(charData);\n      setAirHumidityHistoryCharLabels(charLabels);\n    });\n    /*targetTempData.once('value',data=>{\r\n        setDefTemp(data.val());\r\n    });*/\n  }, []);\n  return __jsx(\"div\", {\n    className: classes.page,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, __jsx(Typography, {\n    component: \"h1\",\n    variant: \"h2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, \"Zavla\\u017Eov\\xE1n\\xED\"), __jsx(\"div\", {\n    className: classes.center,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.controllComponent,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, __jsx(Paper, {\n    elevation: 3,\n    style: {\n      padding: '1rem'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, __jsx(SoilHumidity, {\n    theme: props.theme,\n    value: soilHumidity,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }))), __jsx(\"div\", {\n    className: classes.controllComponent,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }, __jsx(Paper, {\n    elevation: 3,\n    style: {\n      padding: '1rem'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, __jsx(AirHumidity, {\n    theme: props.theme,\n    value: airHumidity,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  })))), __jsx(\"div\", {\n    className: classes.center,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.controllComponent,\n    style: {\n      width: 'calc(100% - 100px)'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, __jsx(Paper, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }, __jsx(Line, {\n    height: 200,\n    data: {\n      labels: aitHumidityHistoryCharLabels,\n      datasets: [{\n        label: 'value',\n        data: airHumidityHistoryCharData,\n        backgroundColor: function (context) {\n          let gradient = context.chart.ctx.createLinearGradient(0, 0, 0, 200);\n          gradient.addColorStop(0, 'rgba(24,184,212,0.5)');\n          gradient.addColorStop(1, 'rgba(24,184,212,0)');\n          return gradient;\n        },\n        pointBackgroundColor: 'rgb(24,184,212)',\n        borderColor: 'rgb(24,184,212)',\n        borderWidth: 0,\n        fill: true\n      }]\n    },\n    options: {\n      scales: {\n        xAxes: [{\n          display: false,\n          gridLines: {\n            display: false\n          }\n        }],\n        yAxes: [{\n          display: true,\n          gridLines: {\n            color: props.theme == 1 ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)',\n            zeroLineColor: props.theme == 1 ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)',\n            drawTicks: false,\n            display: false\n          },\n          ticks: {\n            stepSize: 10,\n            padding: 10\n          }\n        }]\n      },\n      legend: {\n        display: true\n      },\n      maintainAspectRatio: false\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  })))));\n}\n\nfunction ex2(props) {\n  const router = useRouter();\n  const {\n    id\n  } = router.query;\n  const {\n    0: name,\n    1: setName\n  } = useState(\"\");\n  let nameData = firebase.database().ref(\"/users/\" + props.user + \"/devices/\" + id + \"/name\");\n  useEffect(() => {\n    nameData.on('value', data => {\n      setName(data.val());\n    });\n  }, []);\n  return __jsx(WithDrawerAppBar, {\n    component: Id,\n    title: name,\n    deviceId: id.toString(),\n    componentProps: props,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  });\n}\n\nexport default onlyDesktop(withAuth(ex2));","map":{"version":3,"sources":["C:/Users/Jakub Sedlak/WebstormProjects/projekt_CP - typescript/pages/irrigation/[id].tsx"],"names":["makeStyles","React","useEffect","useState","useRouter","Typography","Paper","withAuth","WithDrawerAppBar","firebase","Line","onlyDesktop","SoilHumidity","AirHumidity","useStyle","theme","center","display","width","page","position","controllComponent","margin","padding","Id","props","classes","soilHumidity","setSoilHumidity","airHumidity","setAirHumidity","airHumidityHistoryCharData","setAirHumidityHistoryCharData","aitHumidityHistoryCharLabels","setAirHumidityHistoryCharLabels","defTemp","setDefTemp","router","id","query","timeFormat","soilHumidityData","database","ref","user","airHumidityData","humidityHistoryData","termostatChange","value","set","on","data","val","charData","charLabels","Object","keys","forEach","key","push","time","labels","datasets","label","backgroundColor","context","gradient","chart","ctx","createLinearGradient","addColorStop","pointBackgroundColor","borderColor","borderWidth","fill","scales","xAxes","gridLines","yAxes","color","zeroLineColor","drawTicks","ticks","stepSize","legend","maintainAspectRatio","ex2","name","setName","nameData","toString"],"mappings":"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","sourcesContent":["import Link from \"next/link\";\r\nimport useSWR from 'swr';\r\nimport {DatePicker,MuiPickersUtilsProvider } from '@material-ui/pickers';\r\nimport {createMuiTheme, makeStyles, ThemeProvider} from '@material-ui/core/styles';\r\nimport DateFnsUtils from '@date-io/date-fns';\r\nimport React, {useEffect, useState} from \"react\";\r\nimport {orange} from \"@material-ui/core/colors\";\r\nimport {useRouter} from \"next/router\";\r\nimport {Typography,Paper} from \"@material-ui/core\";\r\nimport withAuth from \"../../components/WithAuth\";\r\nimport WithDrawerAppBar from \"../../components/WithDrawerAppBar\";\r\nimport Tempmeter from \"../../components/Tempmeter\";\r\nimport Termostat from \"../../components/Termostat\";\r\nimport {auth, firebase} from \"../../firebase/index\";\r\nimport IPageProps from \"../../interfaces/IPageProps\";\r\nimport Loading from \"../../components/Loading\";\r\nimport {object, string} from \"prop-types\";\r\nimport {Line} from \"react-chartjs-2\";\r\nimport onlyDesktop from \"../../components/OnlyDesktop\";\r\nimport FireBackground from \"../../components/FireBackground\";\r\nimport {width} from \"@material-ui/system\";\r\nimport {url} from \"inspector\";\r\nimport SoilHumidity from \"../../components/SoilHumidity\";\r\nimport AirHumidity from \"../../components/AirHumidity\";\r\n\r\nconst useStyle = makeStyles(theme=>({\r\n    center:{\r\n        display:'flex',\r\n        width: 'calc(100% - 1px)'\r\n    },\r\n    page:{\r\n        width: '100%',\r\n        position: 'relative'\r\n    },\r\n    controllComponent:{\r\n        margin:'50px',\r\n        width:'min-content',\r\n        padding:'1rem'\r\n    }\r\n}));\r\n\r\nfunction Id(props:IPageProps) {\r\n    const classes = useStyle();\r\n    const [soilHumidity,setSoilHumidity] = useState<number>(0);\r\n    const [airHumidity,setAirHumidity] = useState<number>(0);\r\n    const [airHumidityHistoryCharData,setAirHumidityHistoryCharData] = useState<any>();\r\n    const [aitHumidityHistoryCharLabels,setAirHumidityHistoryCharLabels] = useState<any>();\r\n    const [defTemp,setDefTemp] = useState<number>();\r\n    const router = useRouter();\r\n    const { id } = router.query;\r\n    const timeFormat = 'MM/DD/YYYY HH:mm';\r\n\r\n\r\n    let soilHumidityData = firebase.database().ref(\"/users/\"+props.user+\"/devices/\"+id+\"/soilHumidity\");\r\n    let airHumidityData = firebase.database().ref(\"/users/\"+props.user+\"/devices/\"+id+\"/airHumidity\");\r\n    let humidityHistoryData = firebase.database().ref(\"/users/\"+props.user+\"/devices/\"+id+\"/history/airHumidity\");\r\n    //let targetTempData = firebase.database().ref(\"/users/\"+props.user+\"/devices/\"+id+\"/targetTemp\");\r\n\r\n    const termostatChange = (value:number) => {\r\n        firebase.database().ref(\"/users/\"+props.user+\"/devices/\"+id+\"/targetTemp\").set(value);\r\n    };\r\n\r\n    useEffect(()=>{\r\n        soilHumidityData.on('value',data=>{\r\n            setSoilHumidity(data.val());\r\n        });\r\n\r\n        airHumidityData.on('value',data=>{\r\n            setAirHumidity(data.val());\r\n        });\r\n\r\n        humidityHistoryData.on('value',data=>{\r\n            let charData:any[] = [];\r\n            let charLabels:any[] = [];\r\n            Object.keys(data.val()).forEach(key => {\r\n                charData.push(data.val()[key].value);\r\n                charLabels.push(data.val()[key].time[1]+'/'+data.val()[key].time[2]+'/'+data.val()[key].time[0]+' '+data.val()[key].time[3]+':'+data.val()[key].time[4])\r\n            });\r\n\r\n            setAirHumidityHistoryCharData(charData);\r\n            setAirHumidityHistoryCharLabels(charLabels);\r\n        });\r\n\r\n        /*targetTempData.once('value',data=>{\r\n            setDefTemp(data.val());\r\n        });*/\r\n\r\n    },[]);\r\n\r\n return(\r\n     <div className={classes.page}>\r\n         <Typography component={\"h1\"} variant={\"h2\"}>\r\n             Zavlažování\r\n         </Typography>\r\n         <div className={classes.center}>\r\n             <div className={classes.controllComponent}>\r\n                 <Paper elevation={3} style={{padding: '1rem'}}>\r\n                     <SoilHumidity theme={props.theme} value={soilHumidity}/>\r\n                 </Paper>\r\n             </div>\r\n             <div className={classes.controllComponent}>\r\n                 <Paper elevation={3} style={{padding: '1rem'}}>\r\n                    <AirHumidity theme={props.theme} value={airHumidity} />\r\n                 </Paper>\r\n             </div>\r\n         </div>\r\n         <div className={classes.center}>\r\n            <div className={classes.controllComponent} style={{width:'calc(100% - 100px)'}}>\r\n                <Paper>\r\n                    <Line height={200} data={{\r\n                        labels:aitHumidityHistoryCharLabels,\r\n                        datasets: [{\r\n                            label: 'value',\r\n                            data: airHumidityHistoryCharData,\r\n                            backgroundColor: function(context:any) {\r\n                                let gradient = context.chart.ctx.createLinearGradient(0, 0, 0, 200);\r\n                                gradient.addColorStop(0, 'rgba(24,184,212,0.5)');\r\n                                gradient.addColorStop(1, 'rgba(24,184,212,0)');\r\n                                return gradient;\r\n                            },\r\n                            pointBackgroundColor: 'rgb(24,184,212)',\r\n                            borderColor: 'rgb(24,184,212)',\r\n                            borderWidth: 0,\r\n                            fill:true\r\n                        }]\r\n                    }} options={{\r\n                        scales:{\r\n                            xAxes: [{\r\n                                display:false,\r\n                                gridLines: {\r\n                                    display: false,\r\n                                },\r\n                            }],\r\n                            yAxes: [{\r\n                                display:true,\r\n                                gridLines: {\r\n                                    color:props.theme==1?'rgba(255,255,255,0.1)':'rgba(0,0,0,0.1)',\r\n                                    zeroLineColor:props.theme==1?'rgba(255,255,255,0.1)':'rgba(0,0,0,0.1)',\r\n                                    drawTicks:false,\r\n                                    display:false\r\n                                },\r\n                                ticks: {\r\n                                    stepSize: 10,\r\n                                    padding:10\r\n                                }\r\n                            }],\r\n                        },\r\n                        legend: {\r\n                            display: true,\r\n                        },\r\n                        maintainAspectRatio: false\r\n                    }}/>\r\n                </Paper>\r\n            </div>\r\n         </div>\r\n     </div>\r\n )\r\n}\r\n\r\nfunction ex2(props:IPageProps) {\r\n    const router = useRouter();\r\n    const { id } = router.query;\r\n    const [name,setName] = useState(\"\");\r\n    let nameData = firebase.database().ref(\"/users/\"+props.user+\"/devices/\"+id+\"/name\");\r\n    useEffect(()=>{\r\n        nameData.on('value',data=>{\r\n            setName(data.val());\r\n        });\r\n    },[]);\r\n    return(\r\n        <WithDrawerAppBar component={Id} title={name} deviceId={id.toString()} componentProps={props}/>\r\n    )\r\n}\r\n\r\nexport default onlyDesktop(withAuth(ex2));"]},"metadata":{},"sourceType":"module"}